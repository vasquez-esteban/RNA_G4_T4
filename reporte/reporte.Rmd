---
output:
  html_document:
    toc: false
    css: apa_style.css
    theme: united
    highlight: pygments
    df_print: paged
    number_sections: false
  pdf_document:
    toc: false
---

::: {style="text-align: center; color: black; margin-top: 60px;"}
<h1>TRABAJO 4: AGENTE CREATIVO DE HISTORIAS CON LLMs</h1>
<h2>REDES NEURONALES Y ALGORITMOS BIOINSPIRADOS</h2>
<br><br><br>
<p><strong>Presentado por:</strong></p>
<p>Marcos David Carrillo Builes<br> Tomás Escobar Rivera<br> Jose Fernando López Ramírez <br> Esteban Vásquez Pérez</p>
<br><br>
<p><strong>Profesor:</strong> Juan David Ospina Arango</p>
<p><strong>Monitor:</strong> Andrés Mauricio Zapata Rincón</p>
<br> <img src="logo_unal.png" alt="University Logo" width="100px"/> <br><br>
<p>Universidad Nacional de Colombia<br> Facultad de Minas<br> Ingeniería de Sistemas e Informática</p>
<p><strong>`r format(Sys.Date(), "%d de %B de %Y")`</strong></p>
:::

```{r setup, include=FALSE}
if (!require("pacman")) install.packages("pacman")

pacman::p_load(knitr, kableExtra, magrittr)

knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

<div style="page-break-after: always;"></div>

## Tabla de Contenidos

- [Resumen Ejecutivo](#resumen-ejecutivo)
- [1. Introducción](#introduccion)
- [2. Arquitectura del Sistema](#arquitectura)
- [3. Implementación Técnica](#implementacion)
- [4. Desafíos y Soluciones](#desafios)
- [5. Aspectos Éticos y Consideraciones](#etica)
- [6. Resultados y Evaluación](#resultados)
- [7. Reflexiones y Lecciones Aprendidas](#reflexiones)
- [8. Conclusiones y Trabajo Futuro](#conclusiones)
- [9. Bibliografía](#bibliografia)
- [10. Anexos](#anexos)

---

## Resumen Ejecutivo {#resumen-ejecutivo}

Este proyecto desarrolla un **Agente Creativo de Historias** basado en LLMs que genera narrativas personalizadas utilizando el modelo DeepSeek V3 a través de OpenRouter. El sistema permite a usuarios especificar personajes, escenarios, géneros, tonos y elementos de trama para producir historias coherentes de 300-800 palabras.

La arquitectura modular incluye validación de entradas, ingeniería de prompts, generación con LLM e interfaz web Streamlit. El proyecto aborda el equilibrio entre creatividad y control, manejo de APIs externas, y consideraciones éticas sobre sesgos en contenido generado automáticamente.

Los resultados demuestran capacidad para generar historias narrativamente sólidas que respetan especificaciones del usuario, con una interfaz accesible que facilita exploración creativa e iteración sobre ideas narrativas.

---

# 1. Introducción {#introduccion}

## 1.1 Contexto y Motivación

Los LLMs han revolucionado la generación de texto creativo, pero requieren herramientas que combinen creatividad controlada con usabilidad práctica. Este proyecto surge de la necesidad de crear un sistema que ofrezca control granular sobre elementos narrativos mientras mantiene una interfaz accesible para usuarios no técnicos.

La escritura creativa tradicional requiere dominio técnico del lenguaje y capacidad de estructurar narrativas complejas. Los LLMs modernos han demostrado capacidades notables, pero su naturaleza probabilística introduce desafíos únicos para crear herramientas que combinen creatividad controlada con usabilidad práctica.

## 1.2 Planteamiento del Problema

Los principales desafíos incluyen:

- **Control vs. Creatividad:** Equilibrar especificaciones del usuario con originalidad del output
- **Prompts Creativos:** Diseñar prompts que guíen efectivamente sin limitar creatividad  
- **Validación Compleja:** Validar elementos narrativos subjetivos sin ser restrictivo
- **Gestión de Recursos:** Optimizar uso de APIs manteniendo alta disponibilidad
- **Consideraciones Éticas:** Minimizar sesgos culturales y de género en historias generadas

## 1.3 Objetivos

**Objetivo Principal:** Desarrollar un agente inteligente para generar historias narrativamente coherentes a partir de especificaciones estructuradas.

**Objetivos Técnicos:**
- Sistema robusto de validación de entradas
- Estrategia optimizada de ingeniería de prompts  
- Arquitectura modular escalable
- Integración eficiente con APIs de LLMs

**Objetivos de Usabilidad:**
- Interfaz web intuitiva para usuarios no técnicos
- Retroalimentación inmediata sobre validez de entradas
- Iteración fluida sobre ideas narrativas

## 1.4 Alcances y Limitaciones

**Alcances:** Generación de historias cortas (300-800 palabras) en múltiples géneros, interfaz web interactiva, funcionalidades de descarga, arquitectura modular escalable.

**Limitaciones:** Dependencia de APIs externas, optimización para narrativas cortas, evaluación subjetiva de calidad, sesgos del modelo base, costos operacionales.

---

# 2. Arquitectura del Sistema {#arquitectura}

## 2.1 Diseño Modular

La arquitectura sigue un paradigma modular que separa responsabilidades funcionales: validación de entradas, construcción de prompts, generación mediante LLM e interfaz de usuario. Esta separación facilita mantenimiento, testing y escalabilidad.

La estructura del proyecto refleja esta modularidad:

- **streamlit_app/**: Interfaz de usuario y orquestación

- **core/**: Lógica de negocio principal (validación, prompts, generación)

- **config/**: Configuración centralizada del sistema

- **examples/**: Ejemplos y casos de prueba

## 2.2 Componentes Principales

### Módulo de Configuración
Centraliza parámetros del modelo LLM (DeepSeek V3, temperatura 0.8, límites de tokens 1500), opciones de usuario (géneros, tonos, longitudes) y especificaciones de formato.

### Módulo de Validación  
Implementa validación multicapa: presencia de campos, contenido significativo, formato válido, opciones predefinidas, y estructura narrativa completa.

### Módulo de Ingeniería de Prompts
Construye prompts optimizados para creatividad: estructura narrativa clara, contextualización como "escritor profesional", integración de elementos narrativos, y control de extensión.

### Módulo de Generación
Maneja integración con OpenRouter y DeepSeek V3: configuración de cliente, parámetros optimizados, gestión de errores, y headers para analytics.

## 2.3 Flujo de Procesamiento

El sistema sigue una secuencia lógica:

1. **Captura de Entradas:** Formulario estructurado en Streamlit

2. **Validación:** Verificación exhaustiva antes de procesamiento

3. **Construcción del Prompt:** Transformación de entradas en prompt estructurado

4. **Generación:** Envío a DeepSeek V3 con parámetros optimizados  

5. **Presentación:** Visualización inmediata con funcionalidad de descarga


---

# 3. Implementación Técnica {#implementacion}

## 3.1 Validación de Entradas

El sistema implementa validación jerárquica que evalúa presencia de campos requeridos, contenido significativo usando expresiones regulares para detectar entradas sin valor semántico, opciones predefinidas válidas, y estructura narrativa completa con conflicto, obstáculos y resolución.

## 3.2 Ingeniería de Prompts

La estrategia de prompt engineering incluye contextualización profesional estableciendo al modelo como "escritor profesional", estructura narrativa explícita (Introducción → Desarrollo → Resolución), integración de elementos narrativos con separadores visuales emoji, y especificación clara de límites de longitud y estilo.

## 3.3 Generación con LLMs

La integración con OpenRouter utiliza la biblioteca OpenAI con URL base personalizada, parámetros optimizados (temperatura 0.8 para equilibrar creatividad con coherencia, max_tokens 1500), y headers personalizados para identificación del proyecto.

## 3.4 Interfaz de Usuario

Streamlit proporciona configuración centrada, gestión de estado de sesión para preservar entradas y historias, formulario estructurado con componentes apropiados (text areas, selectboxes, radio buttons), y flujo claro de procesamiento con feedback visual.

---

# 4. Desafíos y Soluciones {#desafios}

## 4.1 Desafíos Técnicos

**Integración con APIs Externas:** Solucionado con configuración de timeouts apropiados, headers personalizados, y estructura modular para facilitar cambio de proveedores.

**Optimización de Parámetros:** Temperatura 0.8 y max_tokens 1500 determinados empíricamente para equilibrar creatividad con coherencia y control de costos.

**Gestión de Estado:** Utilización del session state de Streamlit para preservar contexto entre interacciones.

## 4.2 Prompt Engineering para Creatividad

**Estructuración Efectiva:** Separación clara de elementos narrativos, estructura flexible pero explícita, y contextualización del modelo como "escritor profesional".

**Determinismo vs. Creatividad:** Enfoque de creatividad guiada que proporciona estructura suficiente manteniendo flexibilidad para expresión creativa.

**Diferencias Creativo vs. Factual:** Las tareas creativas requieren contexto emocional y narrativo usando role-playing, mientras las factuales necesitan precisión y restricciones claras.

## 4.3 Usabilidad

**Complejidad de Entrada:** Formulario estructurado con campos etiquetados, iconos emoji para legibilidad, validación en tiempo real, y áreas expandibles.

**Transparencia del Proceso:** Indicadores visuales claros del progreso y estado del sistema durante la generación.

---

# 5. Aspectos Éticos y Consideraciones {#etica}

## 5.1 Sesgos Culturales

**Identificación:** Los LLMs pueden perpetuar sesgos en representación de personajes, escenarios culturales, y resoluciones narrativas basados en sus datos de entrenamiento.

**Mitigación:** El sistema permite especificación explícita de elementos culturales por el usuario, no impone restricciones culturales, y preserva la intención original del usuario.

## 5.2 Rol del Usuario Humano

**Colaboración Humano-IA:** El sistema actúa como herramienta de asistencia creativa donde el usuario define elementos narrativos centrales y retiene control editorial completo, mientras el sistema proporciona construcción técnica y coherencia lingüística.

**Preservación de Autoría:** El usuario mantiene autoría intelectual, el sistema actúa como herramienta de desarrollo, y se preserva control editorial completo.

## 5.3 Uso Responsable

**Limitaciones Reconocidas:** Dependencia de calidad de entrada del usuario y variabilidad inherente del modelo estocástico.

**Recomendaciones:** Revisión editorial obligatoria, atribución apropiada del rol de IA, y validación de coherencia cultural cuando sea relevante.

---

# 6. Resultados y Evaluación {#resultados}

## 6.1 Funcionalidad Técnica

El sistema demuestra funcionamiento robusto en validación de entradas (detección efectiva de campos incompletos y contenido sin significado), generación de historias (producción consistente de narrativas coherentes con integración efectiva de elementos especificados), e interfaz de usuario (flujo intuitivo y funcionalidad operativa completa).

## 6.2 Calidad Narrativa

**Coherencia Estructural:** Las historias siguen consistentemente la estructura planteada con integración orgánica de elementos narrativos y consistencia en caracterización.

**Adherencia a Especificaciones:** Género y tono se reflejan apropiadamente, escenarios se representan fidedignamente, y conflictos se desarrollan coherentemente.

**Creatividad:** Las historias evitan formulaicidad excesiva con variación creativa entre generaciones y expansión imaginativa de elementos.

## 6.3 Experiencia de Usuario

**Usabilidad:** Formulario comprensible para usuarios no técnicos, mensajes de error claros, y proceso rápido y eficiente.

**Satisfacción:** Generación completa en minutos, funcionalidad de descarga efectiva, y capacidad de iteración para refinamiento.

**Limitaciones:** Dependencia de especificidad en entradas y variabilidad ocasional que puede divergir de expectativas específicas.

---

# 7. Reflexiones y Lecciones Aprendidas {#reflexiones}

## 7.1 Desarrollo de IA Creativa

**Prompt Engineering:** El diseño para tareas creativas requiere equilibrio entre structure y freedom. La contextualización como "escritor profesional" resulta más efectiva que instrucciones técnicas directas.

**Arquitectura Modular:** La separación clara entre componentes facilitó significativamente desarrollo iterativo y depuración del sistema.

## 7.2 Colaboración Humano-IA

**Usuario como Co-creador:** Los mejores resultados se obtienen cuando el usuario aporta ideas específicas y contexto cultural detallado, permitiendo que el sistema se enfoque en construcción técnica.

**Control Editorial:** Mantener al usuario en control editorial completo mejora la calidad percibida del output y es éticamente importante.

## 7.3 Limitaciones de LLMs

**Determinismo vs. Creatividad:** Los LLMs generan contenido aparentemente creativo basado en patrones de entrenamiento. La "creatividad" emerge de recombinación novel de elementos aprendidos.

**Sesgos Culturales:** Los modelos muestran sesgo hacia narrativas familiares en datos de entrenamiento. La especificación explícita por el usuario ayuda a contrarrestar estos sesgos.

## 7.4 Decisiones de Diseño

**Decisiones Técnicas Clave:** DeepSeek V3 seleccionado por balance calidad-costo, temperatura 0.8 optimizada empíricamente, estructura de prompt con emojis para parsing visual, validación multicapa para prevenir errores costosos.

**Decisiones de Arquitectura:** Modularidad estricta para facilitar testing y extensión, Streamlit para balance rapidez-funcionalidad, session state management para preservar contexto.

---

# 8. Conclusiones y Trabajo Futuro {#conclusiones}

## 8.1 Logros

**Sistema Funcional Completo:** Agente operacional con integración efectiva entre validación, prompt engineering, comunicación con APIs, e interfaz intuitiva.

**Arquitectura Escalable:** Implementación modular que facilita mantenimiento, testing, y extensión futura con componentes independientes.

**Experiencia Optimizada:** Interfaz que permite a usuarios no técnicos generar historias personalizadas eficientemente con feedback claro.

## 8.2 Limitaciones

**Dependencias Externas:** Dependencia completa de servicios externos introduce puntos de falla potenciales y dependency on pricing structures.

**Escalabilidad:** Costos de API pueden volverse prohibitivos para uso extensivo sin optimizaciones adicionales, y arquitectura actual no optimizada para múltiples usuarios simultáneos.

## 8.3 Trabajo Futuro

**Mejoras Técnicas:** Error handling robusto con retry logic, sistema de cache para reducir costos, soporte múltiples proveedores LLM con failover automático.

**Funcionalidades Avanzadas:** Historia interactiva por capítulos, estilos de autor personalizados, collaborative writing, rich media integration.

**Investigación:** Evaluación automatizada de calidad narrativa, bias detection y mitigation, user studies formales, integración de modelos locales.

## 8.4 Reflexión Final

Este proyecto demuestra el potencial de LLMs como herramientas de asistencia creativa cuando se implementan con focus en colaboración humano-IA. La clave del éxito reside en reconocer fortalezas complementarias: humanos aportan creatividad, contexto y juicio, mientras LLMs proporcionan ejecución técnica, fluidez lingüística y capacidad de iteración rápida.

El futuro de sistemas de IA creativa reside en este enfoque colaborativo donde la tecnología amplifica rather than replaces creatividad humana, manteniendo autoría humana while leveraging capacidades de IA para superar barreras técnicas en el proceso creativo.

---

# 9. Bibliografía {#bibliografia}

<h2>Referencias</h2>

<ul>
  <li>DeepSeek AI. (2024). <i>DeepSeek-V3: Advanced Large Language Model</i> [Large language model]. <a href="https://www.deepseek.com/" target="_blank">https://www.deepseek.com/</a></li>
  <li>OpenRouter AI. (2024). <i>OpenRouter API Documentation</i>. <a href="https://openrouter.ai/docs" target="_blank">https://openrouter.ai/docs</a></li>
  <li>Streamlit Inc. (2024). <i>Streamlit Documentation</i>. <a href="https://docs.streamlit.io/" target="_blank">https://docs.streamlit.io/</a></li>
</ul>

<h2 id="10-anexos">10 Anexos</h2>

<h3>Información del Proyecto</h3>
<ul>
  <li><b>Repositorio principal:</b> <a href="https://github.com/vasquez-esteban/RNA_G4_T4" target="_blank">GitHub - RNA_G4_T4</a></li>
  <li><b>Aplicación web desplegada:</b> <a href="https://rna-g4-generador-historias.streamlit.app/" target="_blank">Aplicación en Streamlit</a></li>
</ul>

<h3>Recursos Complementarios</h3>
<ul>
  <li><b>Video presentación:</b> <a href="https://youtube.com" target="_blank">Enlace pendiente</a></li>
</ul>
